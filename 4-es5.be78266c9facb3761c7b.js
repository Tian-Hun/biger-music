(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{OqcB:function(n,t,e){"use strict";e.r(t);var r=e("keVe"),i=e("bb6g"),a=e("TT6o"),l=e("zvoD"),s=e("dpyN"),u=e("ODRz"),c=function(){function n(n){this.player=n}return n.prototype.initialize=function(n){this.analyser=n,this.analyser.fftSize=256,this.bufferLength=this.analyser.frequencyBinCount,this.frequencyBarGraphs.barWidth=this.canvasElement.width/this.bufferLength*2.5,this.dataArray=new Uint8Array(this.bufferLength)},n.prototype.ngOnInit=function(){var n=this;this.canvasElement=this.canvasElementRef.nativeElement,this.canvasElement.width=window.innerWidth,this.canvasElement.height=window.innerHeight,this.player.analyserChange.pipe(Object(l.a)(function(n){return!!n})).subscribe(function(t){n.initialize(t),n.drawFrequencyBarGraphs()}),this.frequencyBarGraphs={fullWidth:this.canvasElement.width,fullHeight:this.canvasElement.height,barWidth:0,barHeight:0,x:0,ctx:this.canvasElement.getContext("2d")},this.player.songChange.pipe(Object(s.a)(),Object(l.a)(function(n){return!!n})).subscribe(function(t){n.generateLyric(t.lyric)}),this.player.progressTime.pipe(Object(l.a)(function(n){return!!n.original})).subscribe(function(t){for(var e=t.original,r=0,i=0;i<n.lyrics.length;i++)e>n.lyrics[i][0]-1&&(r=i);n.currentIndex=r})},n.prototype.drawFrequencyBarGraphs=function(){this.frequencyBarGraphs.x=0,this.analyser.getByteFrequencyData(this.dataArray),this.frequencyBarGraphs.ctx.clearRect(0,0,this.frequencyBarGraphs.fullWidth,this.frequencyBarGraphs.fullHeight);for(var n=0;n<this.bufferLength;n++){this.frequencyBarGraphs.barHeight=this.dataArray[n];var t=this.frequencyBarGraphs.barHeight+n/this.bufferLength*150,e=n/this.bufferLength*20;this.frequencyBarGraphs.ctx.fillStyle="rgb("+t+", "+e+", 10)",this.frequencyBarGraphs.ctx.fillRect(this.frequencyBarGraphs.x,this.frequencyBarGraphs.fullHeight-this.frequencyBarGraphs.barHeight,this.frequencyBarGraphs.barWidth,this.frequencyBarGraphs.barHeight),this.frequencyBarGraphs.x+=this.frequencyBarGraphs.barWidth+1}requestAnimationFrame(this.drawFrequencyBarGraphs.bind(this))},n.prototype.generateLyric=function(n){void 0===n&&(n="");var t=decodeURIComponent(escape(window.atob(n||"")));this.lyrics=function(n){var t=n.split("\n"),e=/\[\d{2}:\d{2}.\d{2}\]/g,r=[];for(;!e.test(t[0]);)t=t.slice(1);0===t[t.length-1].length&&t.pop();for(var i=0,a=t;i<a.length;i++){var l=a[i],s=l.indexOf("]"),u=l.substring(0,s+1),c=l.substring(s+1),o=u.substring(1,u.length-2),h=o.split(":");r.push([60*parseInt(h[0],10)+parseFloat(h[1]),c])}return r.sort(function(n,t){return n[0]-t[0]}),r}(t)},n.prototype.ngOnDestroy=function(){},n=i.b([Object(u.a)(),i.d("design:paramtypes",[a.a])],n)}();var o=function(){return function(){}}(),h=e("fYis"),p=e("TOqr"),f=[[".lyric-wrapper[_ngcontent-%COMP%]{position:absolute;width:650px;height:65%;top:100px;left:50%;-webkit-transform:translateX(-325px);transform:translateX(-325px);overflow:hidden;z-index:10}.lyric-wrapper[_ngcontent-%COMP%]   .lyric-inner[_ngcontent-%COMP%]{transition:top .3s ease-out;-webkit-transform-origin:0 0 0;transform-origin:0 0 0;position:absolute;left:10px;right:10px;top:280px}.lyric-wrapper[_ngcontent-%COMP%]   .lyric-inner[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{overflow:hidden;height:42px;line-height:42px;text-overflow:ellipsis;white-space:nowrap;font-size:16px;color:rgba(225,225,225,.6);text-align:center;margin:0}.lyric-wrapper[_ngcontent-%COMP%]   .lyric-inner[_ngcontent-%COMP%]   p.active[_ngcontent-%COMP%]{font-size:20px;color:#fff}canvas[_ngcontent-%COMP%]{position:fixed;left:0;top:0;width:100vw;height:100vh}"]],b=r.Ab({encapsulation:0,styles:f,data:{}});function g(n){return r.Tb(0,[(n()(),r.Cb(0,0,null,null,4,"p",[],null,null,null,null,null)),r.Ob(512,null,p.r,p.s,[r.z,r.A,r.o,r.O]),r.Bb(2,278528,null,0,p.i,[p.r],{ngClass:[0,"ngClass"]},null),r.Nb(3,{active:0}),(n()(),r.Rb(4,null,["",""]))],function(n,t){var e=t.component,r=n(t,3,0,t.context.index===e.currentIndex);n(t,2,0,r)},function(n,t){n(t,4,0,t.context.$implicit[1])})}function y(n){return r.Tb(0,[r.Pb(402653184,1,{canvasElementRef:0}),(n()(),r.Cb(1,0,null,null,3,"div",[["class","lyric-wrapper"]],null,null,null,null,null)),(n()(),r.Cb(2,0,null,null,2,"div",[["class","lyric-inner"]],[[4,"top","px"]],null,null,null,null)),(n()(),r.rb(16777216,null,null,1,null,g)),r.Bb(4,278528,null,0,p.j,[r.ab,r.W,r.z],{ngForOf:[0,"ngForOf"]},null),(n()(),r.Cb(5,0,[[1,0],["canvas",1]],null,0,"canvas",[],null,null,null,null,null))],function(n,t){n(t,4,0,t.component.lyrics)},function(n,t){n(t,2,0,300-42*(t.component.currentIndex+1))})}var d=r.yb("biger-home",c,function(n){return r.Tb(0,[(n()(),r.Cb(0,0,null,null,1,"biger-home",[],null,null,null,y,b)),r.Bb(1,245760,null,0,c,[a.a],null,null)],function(n,t){n(t,1,0)},null)},{},{},[]),v=e("X+PR");e.d(t,"MusicModuleNgFactory",function(){return w});var w=r.zb(o,[],function(n){return r.Jb([r.Kb(512,r.l,r.mb,[[8,[h.a,d]],[3,r.l],r.F]),r.Kb(4608,p.m,p.l,[r.B,[2,p.u]]),r.Kb(1073742336,p.c,p.c,[]),r.Kb(1073742336,v.l,v.l,[[2,v.q],[2,v.k]]),r.Kb(1073742336,o,o,[]),r.Kb(1024,v.i,function(){return[[{path:"",component:c}]]},[])])})}}]);